//- Determine if this is a single song or not
-	if (single) {
		//- Determine index position of song
-		var index = collection.items.indexOf(single._id.toString()) + 1;
		//- Structure artist and titles
-		var artist = Array.isArray(single.artist) && single.artist.length > 1 ? single.artist.slice(0, -1).join(', ') + ' & ' + single.artist[single.artist.length -1] : single.artist;
-		var featuredartist = Array.isArray(single.featuredartist) && single.featuredartist.length > 1 ? single.featuredartist.slice(0, -1).join(', ') + ' & ' + single.featuredartist[single.featuredartist.length -1] : single.featuredartist;
-		var combinedArtist = artist + (featuredartist && featuredartist.length > 0 ? (' feat. ' + featuredartist) : '');
-	}

doctype html
html(lang="en-US", class="no-js")
	head
		meta(charset="utf-8")
		title= (single ? combinedArtist + ', "' + single.title + '"' : collection.title) + ' – ' + rootTitle
		<script>document.documentElement.className = document.documentElement.className.replace(/(^|\\\b)no-js(\b|$)/, 'js');if (!("ontouchstart" in document.documentElement)) {document.documentElement.className += " no-touch";}</script>

		meta(name="viewport", content="width=device-width,initial-scale=1.0")
		meta(name="keywords", content="music, best of the year, playlist, best tracks of 2014, songs, tracks, electronica, hiphop, hip-hop, pop, rock, indie, 2014, soundcloud, stream, mp3")
		meta(name="description", content="Cloudlist is a WYSIWYG playlist creation and publishing tool based on SoundCloud.")

		meta(property="og:site_name", content="Cloudlist")
		meta(property="og:url", content="https://cloudlist.io/#{path}/#{single ? single.permalink : ''}")

		if single
			meta(property="og:title", content="#{single.title} by #{single.artist}")
			//- Determine if it's a screenshot of a moving mp4, or just a regular image
			- var cover = single.covers[0].screenshot ? single.covers[0].screenshot : single.covers[0].filename;
			meta(property="og:image", content="https://static.cloudlist.io/media/img/#{cover}")
			meta(property="og:description", content="At position no. #{index} in the list Best Songs of 2014: &quot;#{single.title}&quot; by #{combinedArtist}.")
		else if collection.thumbnails
			meta(property="og:image", content="https://static.cloudlist.io/media/img/#{collection.thumbnails.montage.filename}")
			meta(property="og:description", content="#{collection.description}")
		else
			meta(property="og:image", content="https://static.cloudlist.io/media/img/cloudlist-splash.jpg")
			meta(property="og:description", content="#{collection.description}")

		if prod
			link(href="https://static.cloudlist.io/assets/css/#{assets.styles['templates/' + collection.template + '.css']}", rel="stylesheet")
		else
			link(href="#{rootHost}/assets/css/templates/#{collection.template}.css", rel="stylesheet")
	body
		//- inject:svg
		<svg xmlns="http://www.w3.org/2000/svg" style="display:none"><symbol id="cloudlist-logo" viewBox="0 0 612 90.005"><path d="M222.985 61.332c-1.058 3.986-2.786 7.706-5.185 11.16-2.4 3.46-5.328 6.446-8.782 8.966-3.458 2.523-7.38 4.514-11.772 5.98-4.39 1.464-9.15 2.196-14.27 2.196-6.996 0-13.257-1.222-18.788-3.662-5.53-2.44-10.228-5.69-14.09-9.76-3.864-4.064-6.81-8.803-8.844-14.212-2.034-5.406-3.05-11.12-3.05-17.14 0-5.773.994-11.344 2.99-16.71 1.99-5.37 4.858-10.105 8.6-14.212 3.738-4.106 8.273-7.4 13.6-9.88C168.72 1.578 174.72.336 181.39.336c6.18 0 11.668.834 16.468 2.502 4.798 1.667 8.924 3.924 12.382 6.77 3.457 2.848 6.242 6.204 8.356 10.065 2.113 3.863 3.578 8.032 4.39 12.504h-11.71c-.65-3.09-1.75-5.978-3.292-8.66-1.545-2.684-3.537-5.003-5.978-6.955-2.44-1.952-5.267-3.476-8.478-4.574-3.214-1.098-6.812-1.646-10.797-1.646-5.288 0-9.985.956-14.09 2.867-4.108 1.912-7.563 4.473-10.37 7.684-2.806 3.213-4.96 6.893-6.464 11.04-1.506 4.148-2.256 8.46-2.256 12.93 0 4.718.772 9.17 2.317 13.358 1.544 4.19 3.8 7.87 6.77 11.04 2.968 3.172 6.607 5.693 10.917 7.563 4.31 1.873 9.23 2.806 14.76 2.806 2.927 0 5.794-.444 8.6-1.34 2.806-.894 5.385-2.154 7.746-3.782 2.36-1.625 4.41-3.556 6.16-5.794 1.75-2.236 3.07-4.697 3.966-7.38h12.2v-.002zM237.257 2.29h10.613v85.392h-10.613V2.29zm51.722 86.732c-4.394 0-8.378-.774-11.957-2.317-3.58-1.544-6.63-3.66-9.15-6.343-2.52-2.685-4.473-5.774-5.855-9.27-1.384-3.5-2.074-7.198-2.074-11.103s.69-7.625 2.074-11.164c1.38-3.537 3.333-6.647 5.856-9.33 2.52-2.684 5.57-4.8 9.15-6.344 3.576-1.544 7.562-2.317 11.955-2.317 4.47 0 8.495.773 12.075 2.317 3.578 1.545 6.647 3.66 9.21 6.343 2.563 2.685 4.533 5.795 5.918 9.33 1.382 3.54 2.073 7.26 2.073 11.164s-.69 7.603-2.073 11.1c-1.385 3.498-3.354 6.588-5.917 9.272-2.563 2.683-5.633 4.8-9.21 6.343-3.58 1.544-7.604 2.317-12.077 2.317zm0-9.515c2.845 0 5.427-.526 7.745-1.585 2.318-1.06 4.288-2.46 5.917-4.21 1.624-1.748 2.885-3.803 3.78-6.16.896-2.357 1.342-4.88 1.342-7.563 0-2.685-.446-5.204-1.342-7.564-.895-2.36-2.156-4.433-3.78-6.222-1.628-1.787-3.6-3.212-5.917-4.27-2.317-1.056-4.9-1.584-7.746-1.584-2.848 0-5.41.53-7.688 1.585-2.278 1.058-4.208 2.482-5.795 4.27-1.585 1.788-2.826 3.862-3.72 6.22-.896 2.36-1.342 4.88-1.342 7.564 0 2.682.446 5.205 1.342 7.56.894 2.36 2.135 4.415 3.72 6.162 1.586 1.75 3.517 3.15 5.795 4.21 2.277 1.06 4.84 1.585 7.687 1.585zM380.227 32.3v55.38h-10.613V77.8c-1.628 3.414-4.13 6.14-7.503 8.172-3.376 2.03-7.38 3.052-12.016 3.052-3.904 0-7.26-.63-10.064-1.89-2.805-1.26-5.022-3.03-6.648-5.308-1.545-2.113-2.623-4.472-3.232-7.076-.61-2.6-.915-5.854-.915-9.76V32.3h10.613v29.276c0 2.604.24 5.002.73 7.197.487 2.196 1.28 4.086 2.378 5.67 1.098 1.587 2.52 2.848 4.27 3.783 1.748.937 3.924 1.403 6.526 1.403 2.685 0 5.02-.51 7.015-1.524 1.992-1.018 3.64-2.398 4.94-4.15 1.3-1.747 2.276-3.76 2.928-6.038.65-2.276.977-4.676.977-7.197V32.3h10.613zm59.89 45.744c-1.788 3.413-4.45 6.098-7.988 8.05s-7.34 2.928-11.406 2.928c-4.23 0-8.093-.774-11.59-2.317-3.497-1.544-6.484-3.66-8.965-6.343-2.482-2.685-4.413-5.774-5.796-9.27-1.384-3.5-2.074-7.198-2.074-11.103s.69-7.625 2.074-11.164c1.383-3.537 3.313-6.647 5.795-9.33 2.48-2.684 5.467-4.8 8.965-6.344 3.496-1.544 7.36-2.317 11.59-2.317 4.064 0 7.866.976 11.405 2.928 3.537 1.952 6.2 4.635 7.99 8.052V2.29h10.49v85.392h-10.49v-9.638zm-18.784 1.463c2.846 0 5.43-.526 7.746-1.585s4.287-2.46 5.917-4.21c1.624-1.748 2.885-3.803 3.78-6.16.896-2.357 1.342-4.88 1.342-7.563 0-2.685-.447-5.204-1.343-7.564s-2.156-4.433-3.78-6.222c-1.628-1.787-3.6-3.212-5.917-4.27s-4.9-1.584-7.746-1.584c-2.848 0-5.41.53-7.687 1.585-2.277 1.058-4.208 2.482-5.795 4.27-1.585 1.788-2.826 3.862-3.722 6.22s-1.34 4.88-1.34 7.564c0 2.682.446 5.205 1.34 7.56.896 2.36 2.137 4.415 3.722 6.162 1.587 1.75 3.518 3.15 5.795 4.21s4.84 1.585 7.687 1.585zM469.64 2.29h10.613v85.392H469.64V2.29zm26.47 9.025c0-2.358.813-4.39 2.44-6.1s3.617-2.563 5.977-2.563 4.392.854 6.1 2.563c1.707 1.708 2.563 3.74 2.563 6.1 0 2.36-.856 4.352-2.562 5.978-1.71 1.628-3.74 2.44-6.1 2.44s-4.353-.814-5.98-2.44c-1.625-1.624-2.437-3.617-2.437-5.978zm3.173 20.984h10.612v55.38h-10.612V32.3zm53.063 24.52c2.115.65 4.167 1.34 6.16 2.072 1.992.732 3.762 1.67 5.31 2.807 1.543 1.136 2.782 2.56 3.72 4.27.932 1.706 1.402 3.863 1.402 6.464 0 2.767-.548 5.185-1.646 7.26-1.098 2.072-2.623 3.803-4.574 5.184-1.953 1.383-4.25 2.42-6.893 3.11-2.642.69-5.51 1.037-8.6 1.037-3.093 0-6.02-.408-8.783-1.22-2.767-.812-5.185-2.052-7.26-3.722-2.072-1.665-3.74-3.76-5-6.28s-1.89-5.45-1.89-8.784h10.37c0 4.228 1.238 7.218 3.72 8.966 2.48 1.748 5.59 2.622 9.333 2.622 3.415 0 6.117-.63 8.11-1.89 1.994-1.26 2.99-3.273 2.99-6.04 0-1.543-.41-2.782-1.22-3.72-.813-.934-1.973-1.77-3.477-2.5-1.506-.733-3.354-1.406-5.55-2.016-2.196-.608-4.678-1.403-7.44-2.378-2.116-.65-4.086-1.342-5.918-2.074-1.83-.73-3.416-1.667-4.76-2.805-1.34-1.137-2.398-2.52-3.17-4.148-.774-1.625-1.16-3.7-1.16-6.222 0-2.603.53-4.9 1.588-6.894 1.057-1.99 2.52-3.66 4.39-5 1.87-1.342 4.066-2.358 6.588-3.05 2.52-.69 5.205-1.038 8.052-1.038 3.01 0 5.813.447 8.418 1.34 2.602.897 4.858 2.178 6.77 3.842 1.91 1.67 3.415 3.64 4.513 5.917 1.097 2.28 1.646 4.8 1.646 7.564H557.84c0-3.252-.958-5.752-2.867-7.502-1.91-1.748-4.697-2.622-8.356-2.622-2.927 0-5.367.652-7.317 1.952-1.954 1.302-2.93 3.214-2.93 5.732 0 1.385.347 2.52 1.038 3.416.69.896 1.73 1.67 3.112 2.317 1.38.65 3.05 1.28 5 1.89 1.947.615 4.223 1.328 6.826 2.142zM612 87.68c-1.06.164-2.46.323-4.21.488-1.75.164-3.52.243-5.307.243-1.71 0-3.58-.163-5.61-.486-2.035-.324-3.926-1.117-5.673-2.378-1.75-1.26-3.214-3.19-4.393-5.796-1.18-2.602-1.768-6.18-1.768-10.734V41.204h-10.25V32.3h10.25V13.635h10.61V32.3h14.395v8.904H595.65v25.413c0 2.676.226 4.803.67 6.385.447 1.58 1.078 2.796 1.893 3.648.812.85 1.768 1.396 2.865 1.64 1.098.243 2.337.365 3.722.365h3.843c1.42 0 2.54-.122 3.354-.367v9.394H612zM25.734 0h90.003v12.397H25.734V0zM0 0h12.125v12.397H0V0zm0 38.804h12.125V51.2H0V38.804zM0 77.61h12.125v12.396H0V77.61zm25.734-38.806h71.678V51.2H25.734V38.804zm0 38.806h90.003v12.396H25.734V77.61z"/></symbol><symbol id="icon-audio-paused" viewBox="0 0 73.784 58.753"><path d="M0 41.23h15.62l16.973 15.708V1.815l-16.655 15.71H0z"/></symbol><symbol id="icon-audio-playing" viewBox="0 0 73.784 58.753"><path d="M44.848 16.743l-4.213 4.212c2.17 2.148 3.514 5.127 3.514 8.42s-1.345 6.274-3.515 8.422l4.213 4.213c3.23-3.235 5.23-7.7 5.23-12.634 0-4.932-2-9.397-5.23-12.633zM61.93 29.377c0-8.204-3.334-15.63-8.72-20.995l-4.17 4.17C53.34 16.86 56 22.807 56 29.376S53.342 41.893 49.04 46.2l4.17 4.17c5.386-5.364 8.72-12.79 8.72-20.993zm11.854 0C73.784 17.9 69.122 7.51 61.592 0L57.4 4.19c6.46 6.44 10.456 15.346 10.456 25.187 0 9.84-3.996 18.747-10.456 25.186l4.19 4.19c7.532-7.51 12.194-17.9 12.194-29.376zM0 41.23h15.62l16.973 15.708V1.815l-16.655 15.71H0z"/></symbol><symbol id="icon-caret-asc" viewBox="0 0 612 306"><path d="M306 306L612 0H0l306 306z"/></symbol><symbol id="icon-caret-desc" viewBox="0 0 586.666 293.333"><path d="M293.333 0L0 293.333h586.666L293.333 0z"/></symbol><symbol id="icon-close" viewBox="0 0 23.746 23.746"><path d="M23.746 3.145L20.602.003 11.874 8.73 3.142 0 0 3.144l8.73 8.73L0 20.605l3.142 3.142 8.73-8.73 8.73 8.73 3.144-3.143-8.73-8.73z"/></symbol><symbol id="icon-fullscreen" viewBox="0 0 23.997 19.49"><path d="M0 0v7.18h2V2.053h5V0H2zm2 12.31H0v7.18h7v-2.052H2zm19.997 0v5.128h-5v2.052h7v-7.18zm0-5.13h2V0h-7v2.052h5z"/></symbol><symbol id="icon-info" viewBox="0 0 5.245 8.712"><path d="M1.908 6.288c0-.288.018-.542.054-.762.036-.22.096-.42.18-.6.084-.18.192-.345.324-.493.132-.148.298-.29.498-.426l.384-.282c.136-.108.264-.23.384-.366.12-.137.22-.29.3-.463.08-.172.12-.366.12-.582 0-.44-.136-.772-.407-.996-.273-.224-.637-.336-1.093-.336-.448 0-.82.14-1.116.42-.296.28-.444.688-.444 1.224H0c0-.408.07-.776.21-1.104S.54.92.78.696C1.02.472 1.3.3 1.62.18 1.94.06 2.284 0 2.652 0s.712.054 1.032.162c.32.108.594.262.822.462.228.2.408.442.54.726.132.284.198.606.198.966 0 .296-.047.556-.14.78-.09.224-.2.422-.334.594-.132.172-.273.318-.426.438l-.408.312c-.19.144-.35.272-.474.384-.124.112-.224.232-.3.36s-.128.278-.156.45c-.028.172-.042.39-.042.654H1.908zm-.336 1.535c0-.24.082-.443.246-.61.164-.17.37-.253.618-.253s.458.084.63.252c.172.168.258.372.258.61 0 .24-.086.45-.258.626-.172.176-.382.264-.63.264s-.454-.088-.618-.264c-.164-.176-.246-.385-.246-.625z"/></symbol><symbol id="icon-pause-main" viewBox="0 0 612 612"><path d="M306 612C137.27 612 0 474.73 0 306S137.27 0 306 0s306 137.27 306 306-137.27 306-306 306zm0-587.52C150.772 24.48 24.48 150.772 24.48 306S150.772 587.52 306 587.52 587.52 461.228 587.52 306 461.228 24.48 306 24.48zm-116.28 153h73.44v257.04h-73.44zm159.12 0h73.44v257.04h-73.44z"/></symbol><symbol id="icon-play-main" viewBox="0 0 612 612"><path d="M306 612C137.27 612 0 474.73 0 306S137.27 0 306 0s306 137.27 306 306-137.27 306-306 306zm0-587.52C150.772 24.48 24.48 150.772 24.48 306S150.772 587.52 306 587.52 587.52 461.228 587.52 306 461.228 24.48 306 24.48zm-67.32 136.94v289.152L435.94 306z"/></symbol><symbol id="icon-spinner" viewBox="0 0 100 100"><linearGradient id="a" gradientUnits="userSpaceOnUse" x1="30" y1="100" x2="50"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-opacity=".2"/></linearGradient><path fill="url(#a)" d="M50.07.078C22.473.078.102 22.448.102 50.044c0 27.595 22.37 49.966 49.966 49.966s49.965-22.37 49.965-49.966S77.665.078 50.07.078zm-.06 84.984c-19.316 0-34.976-15.66-34.976-34.976 0-19.317 15.66-34.976 34.976-34.976s34.977 15.66 34.977 34.976c0 19.315-15.66 34.976-34.977 34.976z"><animateTransform attributeName="transform" attributeType="XML" type="rotate" from="0 50 50" to="360 50 50" begin="0s" dur="1s" repeatCount="indefinite"/></path></symbol><symbol id="icon-state-pause" viewBox="0 0 16 19"><path d="M0 0h5.053v18.934H0zm10.947 0H16v18.934h-5.053z"/></symbol><symbol id="icon-state-play" viewBox="0 0 16 19"><path d="M0 0v19l16-9.5z"/></symbol></svg>
		//- endinject
		header(class="main-header inner", role="banner")
			a(href="/", title="Go to main page")
				span.structural Cloudlist
				| <svg class="logo" viewBox="0 0 371.83 54.684"><use xlink:href="#cloudlist-logo"></use></svg>
			div.controls
				button.fullscreen
					span.structural Toggle fullscreen mode
					| <svg viewBox="0 0 23.997 19.49"><use xlink:href="#icon-fullscreen"></use></svg>
				button.info-toggle
					span.structural Toggle info screen
					| <svg viewBox="0 0 5.245 8.712"><use xlink:href="#icon-info"></use></svg>
				button.play-state
					span.structural Toggle play/pause
					| <svg viewBox="0 0 16 19" class="play"><use xlink:href="#icon-state-play"></use></svg>
					| <svg viewBox="0 0 16 19" class="pause"><use xlink:href="#icon-state-pause"></use></svg>
				input.volume-slider(type="range", step="1", value="90", min="0", max="100")

		main(role="main")
			block content

		footer(role="contentinfo")
			small.structural Copyright 2014
		div.dialog-overlay
		div.dialog(aria-hidden="true")
			section.info
				button.close-dialog
					span.structural Close
					| <svg viewBox="0 0 23.746 23.746"><use xlink:href="#icon-close"></use></svg>
			section.keyboard-mapping.group
				header
					h4 Keyboard commands
				dl.big
					dt
						kbd space
					dd Play/pause track
				dl.medium
					dt
						kbd Esc
					dd Close all open dialogs
				dl.arrow
					dt
						kbd &rarr;
					dd Play next track
				dl
					dt
						kbd ⇧
						kbd F
					dd Switch to fullscreen
				dl.arrow
					dt
						kbd &larr;
					dd Play previous track
				dl
					dt
						kbd M
					dd Toggle mute
			footer
				small Cloudlist is a WYSIWYG playlist creation and publishing tool based on SoundCloud. It’s currently in super-private (as in, only one person uses it) alpha.
		noscript
			div#noscript-warning
				a.close-dialog(href="#noscript-warning")
					span.structural Close
					| <svg viewBox="0 0 23.746 23.746"><use xlink:href="#icon-close"></use></svg>
				h4 :(
				p It seems you have disabled JavaScript in your browser.
				p I know this sucks. I really do. But this whole thing kinda depends on JavaScript being activated.
				p However, if you want to just view the content without interacting with it, click the X in the upper corner of this box to close the message, and then scroll away to your heart's content.
		script.
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-58137452-1', 'auto');ga('send', 'pageview');
		if single
			- var obfuscatedId = hashids.encodeHex(single._id);
			script.
				autostart = '#{obfuscatedId}';

		if prod
			script(src="https://static.cloudlist.io/assets/js/#{assets.scripts['common.js']}")
			script(src="https://static.cloudlist.io/assets/js/#{assets.scripts[collection.template + '.js']}")
		else
			script(src="#{rootHost}/assets/js/common.js")
			script(src="#{rootHost}/assets/js/#{collection.template}.js")